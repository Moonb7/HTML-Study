> ### Raw Query란

데이터베이스에 SQL을 이용하여 직접 쿼리를 요청하는 것을 뜻합니다.
SQL만 알고 있더라도 다양한 데이터베이스에 연결하여 테이블을 생성하거나 데이터를 조회하는 등 다양하게 데이터베이스와 상호작용을 할 수 있습니다.

> #### Raw Query 시작

Node.js에서 Raw Query를 사용하기 위해서는 AWS RDS에서 대여받은 MySQL에 연결을 도와주는 데이터베이스 드라이버가 필요합니다. 그래서 Node.js에서 MySql DB를 사용할 수 있게 해주는 mysql2 라이브러리를 설치하여 이용합니다.

- mysql2 데이터베이스와 개발 언어 사이를 연결해주는 역할을 해주어 데이터베이스 드라이버라는 이름으로도 불린다고 합니다.

> #### mysql2

라이브러리에서 DB를 연결하기 위한 속성은 크게 4가지로 구성됩니다.

- host : DB 드라이버가 접속할 DB의 주소를 나타냅니다(예 AWS RDS 엔드 포인트)
- user : AWS RDS DB의 계정 명을 나타냅니다.
- password : AWS RDS DB의 비밀번호를 나타냅니다.
- database : AWS RDS DB의 DB명을 나타냅니다.
  이외에도, timezone으로 시간대를 설정하거나, ssl로 SSL인증서를 설정하는 것과 같은 다양한 옵션을 설정할 수 있습니다.

Raw Query는 connect.promise().query() 형식으로 사용가능합니다. 여기서, 데이터 정의어 (DDL), 데이터 조작어(DML) 등 다양한 SQL명령어를 사용할 수 있습니다.

- 이러한 형태로 ``await connect.promise().query(` ...SQL 명령어 `)``
  - promise로 반환을 해주어 await키워드를 이용해 안전하게 sql문을 실행합니다.
- SHOW TABLES명령어로 간단히 테이블을 조회 할 수 있습니다.
  - `` const [tableList] = await connect.promise().query(`SHOW TABLES`);`` 이러한 형태로 조회한 첫번째 배열값을 할당합니다. 배열구조분해 할당 문법때문에 첫번째 배열 첫번째 값이 tableList에 할당됩니다.
  - 추가로 SHOW TABLES와 SELECT 문법 같이 조회 명령어는 반환값이 존재하게 됩니다.

> #### Raw Query 단점

- 만약 컬럼의 이름을 변경한다고 하면 일일이 코드 하나하나 변경해줘야 하는 유지보수성에 문제가 있습니다.
- 사용자가 전달한 데이터를 DB에 직접 요청하게 되므로 사용자가 악의적인 쿼리로 서버에 접속하여 관리자의 계정을 탈취하거나 다른 사용자들의 정보를 탈취하는 것과 같이 모든 웹 사이트 해킹 기법 중 많은 문제를 야기하는 SQL 인젝션의 취약점을 가지고 있습니다.

#### 이러한 문제로 ORM 등장

그래서 이러한 단점을 보완하기위해 ORM이라는 기술이 나오게 되었습니다.
Node.js에서는 Prisma라는 ORM을 사용하여 SQL을 직접 작성하지 않고, JavaScript만으로 DB를 조작하여 코드의 유지보수성을 증가하게 되고, 더욱 객체지향적인 프로그래밍이 가능하게 만들 수 있게 됩니다.
