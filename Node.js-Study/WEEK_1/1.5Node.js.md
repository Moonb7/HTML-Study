### Node.js란?

Chrome V8 JavaScript 엔진으로 빌드된 JavaScript 런타임입니다.
Node.js는 이벤트 기반, 논 블로킹 I/O 모델을 사용해 가볍고 효율적입니다. Node.js 패키지 생태계인 npm은 세계에서 가장 큰 오픈 소스 라이브러리 생태계이기도 합니다. ???뭔 말이지

Node.js는 JavaScript를 브라우저가 아닌 컴퓨터에서 브라우저 없이 실행하게 도와주는 환경이라고 합니다. 이는 핵심적인 core 라이브러리와, V8엔진, libuv 라이브러리를 통해 가능해집니다.

- Core Library : 파일을 입출력하거나 파일을 쓰거나 저장하거나 할때 사용하는 fs라이브러리나, 운영체제와 관련된 os, 여러가지의 프로세스(프로그램)와 스레드를 관리하는 "Process"라고하는 core라이브러리들이 존재합니다.

- V8 : 구글이 개발하여 구글 크롬 브라우저에서 사용하는 자바스크립트 엔진입니다. 자바스크립트를 해석을 하고 실제로 결과값을 출력해주는 담당을 합니다. Node.js에선 이 엔진을 활용함으로써, 브라우저 환경 이외에서도 자바스크립트를 사용할 수 있습니다.

- libuv : 비동기적인 작업을 도와주게하는 라이브러리입니다.
  Node.js가 비동기 I/O 작업을 수행할 수 있게 해주는 중요한 라이브러리입니다. 이 라이브러리 덕분에 Node.js는 논 블로킹 I/O 모델이라는 특징을 가지게 되었고, 이를 통해 여러 요청을 효율적으로 처리할 수 있게 되었습니다.

참고로 두 가지 주요 구성 요소인 V8엔진과 libuv는 C와 C++ 언어로 작성되어 있습니다. 참고만 하시면 될 것 같습니다.

Node.js의 대표적인 특성은 논 블로킹(Non-blocking)I/O, 싱글 스레드(Single Thread), 이벤트 루프(Event Loop) 등이 있습니다.

### 논 블로킹 I/O (Non-Blocking Input/Output)

블로킹 I/O와 논 블로킹 I/O는 프로그램의 실행 흐름을 제어하는 방식입니다.
I/O는 데이터의 입력(Input) / 출력(Output)을 의미하며, 파일을 저장하거나, 불러오는 것을 "I/O 처리를 한다"라고 표현할 수 있습니다.

- 블로킹 I/O : 한 번에 하나의 작업만을 처리할 수 있으며, 호출된 함수가 자신의 작업을 모두 마칠 때 까지 호출한 함수에게 제어권을 넘겨주지 않습니다. 오 동기적으로 움직인다는 말이네요!!

- 논 블로킹 I/O : 시스템 호출이 완료되기를 기다리지 않고 바로 다음 작업으로 즉시 넘어 갈 수 있는 방식으로 호출된 함수는 작업의 완료 여부와 상관없이 즉시 제어권을 호출한 함수에게 반환합니다.
  비동기적으로 움인직다는 말이네요!!

### 싱글 스레드(Single Thread)

스레드 하나를 사용하는 것이며, 동시에 하나의 작업만을 처리할 수 있음을 의미합니다.

스레드란? : 프로그램이 동작할 때, CPU 또는 프로세서를 사용하는 단위로, 여러 스레드를 사용하면 여러 작업을 동시에 처리할 수 있습니다. 그러나 이는 복잡성을 증가시키고, 리소스를 더욱 많이 소모하게 되는 단점이 있습니다. 비즈니스 로직을 처리하기위한 작업단위이다.

- Node.js는 싱글 스레드로 동작하지만 I/O 작업이 발생한 경우 이를 비동기적으로 처리하여 여러 작업을 동시에 처리할 수 있게 합니다.

- Node.js는 싱글 스레드 + 이벤트 루프 방식을 사용하여 동시에 많은 요청을 효율적으로 처리할 수 있습니다.

- 싱글 스레드는 스레드 생성과 관리에 드는 부담을 줄여주며, 컴퓨팅 리소르를 효율적이게 사용하게 할 수 있습니니다.
  그리고 멀티 스레드의 단점 중 하나 공유하는 자원에 대한 동시접근 문제(Race condition) 즉 동시성 문제를 방지 할 수 있습니다.

- 싱글 스레드 방식은 CPU 집중적인 작업에는 어울리지는 않고 이럴때 멀티 스레드 방식이 효율적일 수 있습니다. 그래서 Node.js는 이 약점을 극복하기 위해 "Process" 라고하는 "core library"를 이용을해서 마치 멀티 스레드처럼 구현을 할 수 있습니다.

### 호출 스택(Call Stack)

호출 스택은 함수의 실행 순서를 추적하는 자료구조입니다.

- JavaScript에서 함수를 실행하면 호출 스택에 쌓이면서(push) 함수가 완료되면 호출 스택에 제거(pop) 됩니다.

- 함수들을 순차적으로 처리하기 위해 호출 스택을 이용합니다.

- 비동기적 작업에는 문제가 생길수 있습니다. 함수들이 순차적으로 실행 되는 동안 특히 네트워크 요청과 같이 "Open API" 등을 가지고 오는 작업을 하면 시간이 걸리면서 다른 작업을 기다리게 됩니다.
  그래서 JavaScript는 이벤트 루프(Event Loop)와 이벤트 큐(Event Queue)를 사용해 비동기적으로 함수를 이용해 작업을 이어나갈 수 있습니다.

### 이벤트 루프(Event Loop)

여러 이벤트들과 같은 비동기 작업들을 모아서 관리하고, 어떤 순서대로 실행해야하는지 도와주는 도구입니다.

- 만약 JavaScript 파일을 실행하게 되는데 비동기적인 함수를 실행하면 호출 스택이 아닌 Libuv안에 있는 이벤트 큐에 들어가게 됩니다. 이벤트 루프는 계속해서 감시하면서 이 비동기적으로 실행하는 함수의 특정 해당하는 조건이 완료되면 이 함수를 호출 스택(Call Stack)에다가 전달해 주어 처리합니다.

- 이벤트 루프는 호출 스택과 이벤트 큐를 관찰하면서, **호출 스택이 비어있고**, 이벤트 큐에 작업이 있다면, 이벤트 큐의 작업을 호출 스택으로 이동하는 역할을 담당합니다.
  추가 호출스택이 비어있지않으면 이벤트 큐에서 대기하고 있다가 호출 스택으로 이동이 됩니다.

- 즉, 이벤트 루프를 활용하여, 자바스크립트는 비동기작업(시간이 걸리는 작업)을 이벤트 큐에 넣어 비동기적으로 처리하고, 그 동안 호출 스택에서 다른 작업들을 계속 처리할 수 있게됩니다.

```
function firstFunction() {
  console.log('firstFunction 입니다.');
  secondFunction();
}

function secondFunction() {
  // 5 초간 기다린다.
  setTimeout(function () {
    console.log('secondFunction 입니다.');
  }, 5000);
}

firstFunction();
console.log('전역 코드 실행 중!');

// 출력 : firstFunction 입니다.
// 출력 : 전역 코드 실행 중!
/** 5 초간 기다린다. **/
// 출력 : secondFunction 입니다.
```

**설명**

1. firstFunction() 실행하면 일단 호출스택에 firstFunction()올라갑니다.
   console.log()도 호출 스택에 올라가고 처리후 console.log()는 호출 스택에서 삭제 됩니다.

2. secondFunction()도 호출 스택에 올라가고, setTimeout()도 호출 스택으로 올라갑니다. 그리고 안에 인자값으로 들어 있는 콜백함수는 이벤트 큐에 올라갑니다.

3. 그동안 호출 스택에 있는 함수들은 순차적으로 실행하고 삭제되고 5초뒤 콜백함수가 실행되고 호출 스택으로 이동하고 바로 삭제됩니다.

주의 setTimeout() 함수 자체는 호출 스택에 들어갔다가 바로 빠져나가고, 이벤트 큐에는 콜백 함수만 대기하게 되는 점이 중요합니다.

### Node.js의 REPL 환경

**REPL 환경이란**

- 입력 받은 코드를 읽어(Read)들여 메모리에 저장하고, 평가(Evaluate)된 값을 출력(Print)합니다. 특정 신호를 입력받기 전까지 위의 과정을 반복(Loop) 합니다.

- 사용자가 입력한 코드의 결과를 즉시 확인할 수 있기 때문에 간단한 코드 문법을 테스트하는데 아주 적합한 개발 환경으로 볼 수 있습니다.

- REPL 환경에서 console.log("Hello World")와 같이 입력하면 "Hello World"를 즉시 출력해 줍니다.

**웹 브라우저의 개발자 도구 콘솔과의 차이**

둘다 REPL 환경이지만 웹 브라우저와 Node.js가 제공하는 여러 API와 라이브러리가 달라, 웹 브라우저에서는 DOM(Document Object Model)을 제어하여 HTML 요소를 생성하거나 변경하는 작업을 할 수 있습니다.
Node.js REPL환경은 백엔드 서버(Server)의 코드를 테스트하거나 실험해보는데 에 더 적합하고, 웹 브라우저 콘솔은 클라이언트(Client)의 코드를 작서하거나 테스트 하는데에 적합하다고 합니다.
